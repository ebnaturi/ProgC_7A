import requests
import threading
import time
import random

def leer_api(thread_id):
    # Generamos un tiempo de espera aleatorio entre 0 y 3 segundos
    tiempo_espera = random.uniform(0, 3)
    print(f"Hilo {thread_id} durmiendo por {tiempo_espera:.2f} segundos antes de leer la API.")
    time.sleep(tiempo_espera)

    # Construimos la URL para leer un post específico de JSONPlaceholder
    url = f"https://jsonplaceholder.typicode.com/posts/{thread_id + 1}"
    print(url)
    try:
        response = requests.get(url)
        if response.status_code == 200:
            data = response.json()
            # Imprimimos solo el título del post
            print(f"Hilo {thread_id} - Título: {data['title']}")
        else:
            print(f"Hilo {thread_id} - Error al acceder a la API. Código: {response.status_code}")
    except Exception as e:
        print(f"Hilo {thread_id} - Excepción al leer la API: {e}")

def main():
    hilos = []
    for i in range(5):
        hilo = threading.Thread(target=leer_api, args=(i,))
        hilos.append(hilo)
        hilo.start()

    for hilo in hilos:
        hilo.join()

if __name__ == "__main__":
    main()
